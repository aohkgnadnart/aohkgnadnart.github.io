<!doctype html><html lang=en dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Một ngày đẹp trời nọ, trên vương quốc của các Coders 2011, bỗng xuất hiện 1 lão phù thủy độc ác, lão phù thủy sirDat_LS đã có âm mưu thôn tính đất nước  của đức vua vodanh9x. Lão phù thủy này rất yêu con gái của đức vua là Rose và đã bắt Rose về nơi ở của lão ta.
Đức vua vodanh9x liền tìm hiệp sĩ Robin và sẽ hứa gả con gái cho Robin nếu chàng cứu được công chúa Rose trở về. Lão phù thủy sirDat_LS độc ác với khuôn mặt rất ghê tởm khiến công chúa mỗi khi nhìn thấy hắn thì công chúa lại ngất đi.
Và rồi, chàng Robin của chúng ta đã tìm được đến nơi ở của lão phù thủy. Nơi ở của lão là 1 mê cung có N phòng, và N phòng này liên thông với nhau và có đúng N-1 đường đi (coi mỗi đường đi là 1 cạnh).
Nhưng khó khăn thay, lão phù thủy đã đánh số mỗi đường đi là 1 hoặc 2. Nếu chàng Robin muốn đến cứu công chúa, thì từ nơi xuất phát đến nơi có công chúa phải có ít nhất một đường đi được đánh số 2, nếu không chàng Robin sẽ chết.
Yêu cầu: Cho m truy vấn (m <= 10^5) mỗi truy vấn có dạng (x,y), trong đó x là nơi xuất phát của Robin và y là nơi nhốt công chúa. Xác định đường đi ngắn nhất từ x đến y có cạnh co trọng số 2 hay không."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/posts/2021-10-21-Robin/"><meta property="og:site_name" content="Aohkgnadnart Blog"><meta property="og:title" content="Problem: Robin"><meta property="og:description" content="Một ngày đẹp trời nọ, trên vương quốc của các Coders 2011, bỗng xuất hiện 1 lão phù thủy độc ác, lão phù thủy sirDat_LS đã có âm mưu thôn tính đất nước của đức vua vodanh9x. Lão phù thủy này rất yêu con gái của đức vua là Rose và đã bắt Rose về nơi ở của lão ta.
Đức vua vodanh9x liền tìm hiệp sĩ Robin và sẽ hứa gả con gái cho Robin nếu chàng cứu được công chúa Rose trở về. Lão phù thủy sirDat_LS độc ác với khuôn mặt rất ghê tởm khiến công chúa mỗi khi nhìn thấy hắn thì công chúa lại ngất đi.
Và rồi, chàng Robin của chúng ta đã tìm được đến nơi ở của lão phù thủy. Nơi ở của lão là 1 mê cung có N phòng, và N phòng này liên thông với nhau và có đúng N-1 đường đi (coi mỗi đường đi là 1 cạnh).
Nhưng khó khăn thay, lão phù thủy đã đánh số mỗi đường đi là 1 hoặc 2. Nếu chàng Robin muốn đến cứu công chúa, thì từ nơi xuất phát đến nơi có công chúa phải có ít nhất một đường đi được đánh số 2, nếu không chàng Robin sẽ chết.
Yêu cầu: Cho m truy vấn (m <= 10^5) mỗi truy vấn có dạng (x,y), trong đó x là nơi xuất phát của Robin và y là nơi nhốt công chúa. Xác định đường đi ngắn nhất từ x đến y có cạnh co trọng số 2 hay không."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2025-04-02T13:02:07+07:00"><meta property="article:tag" content="Cp"><meta property="article:tag" content="Tree"><meta property="article:tag" content="Dsu"><meta property="article:tag" content="Lca"><title>Problem: Robin | Aohkgnadnart Blog</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://localhost:1313/posts/2021-10-21-Robin/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.13e139159b5ca30479736515fd7347cdfcfa90e8d16be14160001aec6b9261cd.js integrity="sha256-E+E5FZtcowR5c2UV/XNHzfz6kOjRa+FBYAAa7GuSYc0=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Aohkgnadnart Blog</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=/zh/>Chinese</a></li><li><a href=/he/>Hebrew</a></li></ul></li></ul><ul><li class=book-section-flat><a href=/docs/example/>Trang Chủ</a><ul><li><input type=checkbox id=section-a5446993f02613041412a70215fe0f5e class=toggle>
<label for=section-a5446993f02613041412a70215fe0f5e class="flex justify-between"><a role=button>Interview</a></label><ul><li><input type=checkbox id=section-aeab3a266eabe870acc3c276e725ff38 class=toggle>
<label for=section-aeab3a266eabe870acc3c276e725ff38 class="flex justify-between"><a href=/docs/example/collapsed/3rd-level/>C++</a></label><ul></ul></li></ul></li></ul></li></ul><ul><li><a href=/posts/>Competitive Programming</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Problem: Robin</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class="markdown book-post"><h2>Problem: Robin</h2><div class=text-small><a href=/tags/cp/>Cp</a>,
<a href=/tags/tree/>Tree</a>,
<a href=/tags/dsu/>Dsu</a>,
<a href=/tags/lca/>Lca</a></div><div class=book-post-content><p>Một ngày đẹp trời nọ, trên vương quốc của các Coders 2011, bỗng xuất hiện 1 lão phù thủy độc ác, lão phù thủy sirDat_LS đã có âm mưu thôn tính đất nước của đức vua vodanh9x. Lão phù thủy này rất yêu con gái của đức vua là Rose và đã bắt Rose về nơi ở của lão ta.</p><p>Đức vua vodanh9x liền tìm hiệp sĩ Robin và sẽ hứa gả con gái cho Robin nếu chàng cứu được công chúa Rose trở về. Lão phù thủy sirDat_LS độc ác với khuôn mặt rất ghê tởm khiến công chúa mỗi khi nhìn thấy hắn thì công chúa lại ngất đi.</p><p>Và rồi, chàng Robin của chúng ta đã tìm được đến nơi ở của lão phù thủy. Nơi ở của lão là 1 mê cung có N phòng, và N phòng này liên thông với nhau và có đúng N-1 đường đi (coi mỗi đường đi là 1 cạnh).</p><p>Nhưng khó khăn thay, lão phù thủy đã đánh số mỗi đường đi là 1 hoặc 2. Nếu chàng Robin muốn đến cứu công chúa, thì từ nơi xuất phát đến nơi có công chúa phải có ít nhất một đường đi được đánh số 2, nếu không chàng Robin sẽ chết.</p><p>Yêu cầu: Cho m truy vấn (m &lt;= 10^5) mỗi truy vấn có dạng (x,y), trong đó x là nơi xuất phát của Robin và y là nơi nhốt công chúa. Xác định đường đi ngắn nhất từ x đến y có cạnh co trọng số 2 hay không.</p><p><strong>Ràng buộc</strong></p><pre tabindex=0><code>N &lt;= 1e4
</code></pre><p><strong>Input</strong></p><pre tabindex=0><code>6 7
1 1
1 2
3 1
1 2
5 2
1 3
5 1
2 1
2 1
1 2
2 4
1 2
</code></pre><p><strong>Output</strong></p><pre tabindex=0><code>YES
YES
NO
NO
NO
YES
NO
</code></pre><p><em>Submit
<a href=https://oj.vnoi.info/problem/c11bc2>tại đây</a></em></p><p><strong>Hướng dẫn 1: LCA</strong></p><ul><li>Tìm tổ tiên chung gần nhất của (x, y) sau đó kiểm tra đoạn đường từ x đến lca(x, y) xem có cạnh nào là 2 không. làm tương tự với y.</li></ul><p><strong>Code</strong></p><ul><li>Độ phức tạp <strong>O(n * logn + m * logn * logn)</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#75715e>#define debug(x) cerr &lt;&lt; #x &lt;&lt; &#34; = &#34; &lt;&lt; x &lt;&lt; endl;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// freopen(&#34;input.txt&#34;, &#34;r&#34;, stdin);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(<span style=color:#ae81ff>0</span>);cin.tie(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin <span style=color:#f92672>&gt;&gt;</span> n <span style=color:#f92672>&gt;&gt;</span> m;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> adj[n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;=</span> n; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, k;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> k;
</span></span><span style=display:flex><span>        adj[x].push_back(make_pair(i, k));
</span></span><span style=display:flex><span>        adj[i].push_back(make_pair(x, k));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> dist(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), cost(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), par(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>void</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> dfs <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> u, <span style=color:#66d9ef>int</span> p){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> val: adj[u]){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> val.first;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> val.second;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(v <span style=color:#f92672>==</span> p) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            par[v] <span style=color:#f92672>=</span> u;
</span></span><span style=display:flex><span>            dist[v] <span style=color:#f92672>=</span> dist[u] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            cost[v] <span style=color:#f92672>=</span> cost[u] <span style=color:#f92672>+</span> x;
</span></span><span style=display:flex><span>            dfs(v, u);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    dfs(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> h <span style=color:#f92672>=</span> ceil(log2(n));
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> sp(h <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; j <span style=color:#f92672>&lt;=</span> n; j<span style=color:#f92672>++</span>) sp[<span style=color:#ae81ff>0</span>][j] <span style=color:#f92672>=</span> par[j];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> h; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; j <span style=color:#f92672>&lt;=</span> n; j<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            sp[i][j] <span style=color:#f92672>=</span> sp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][sp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][j]];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> find <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> x,<span style=color:#66d9ef>int</span> k){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;=</span> h; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>((k <span style=color:#f92672>&gt;&gt;</span> i)<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span>) x <span style=color:#f92672>=</span> sp[i][x];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> lca <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(dist[x] <span style=color:#f92672>&lt;</span> dist[y]) swap(x, y);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> del <span style=color:#f92672>=</span> dist[x] <span style=color:#f92672>-</span> dist[y];
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> find(x, del);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(x <span style=color:#f92672>==</span> y) <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> p <span style=color:#f92672>=</span> h;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span>(p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> sp[p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][x] <span style=color:#f92672>==</span> sp[p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][y]) p<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> l <span style=color:#f92672>=</span> max(<span style=color:#ae81ff>1</span>, (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> r <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> p);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span>(true){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(r <span style=color:#f92672>-</span> l <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> u <span style=color:#f92672>=</span> find(x, l);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> find(y, l);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span>(u <span style=color:#f92672>==</span> v) <span style=color:#66d9ef>return</span> u;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> find(y, r);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> mid <span style=color:#f92672>=</span> ((l <span style=color:#f92672>+</span> r) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> u <span style=color:#f92672>=</span> find(x, mid);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> find(y, mid);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(u <span style=color:#f92672>==</span> v) r <span style=color:#f92672>=</span> mid;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> l <span style=color:#f92672>=</span> mid;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(m<span style=color:#f92672>--</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, y;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> y;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> z <span style=color:#f92672>=</span> lca(x, y);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(dist[x] <span style=color:#f92672>-</span> dist[z] <span style=color:#f92672>&lt;</span> cost[x] <span style=color:#f92672>-</span> cost[z] <span style=color:#f92672>||</span> dist[y] <span style=color:#f92672>-</span> dist[z] <span style=color:#f92672>&lt;</span> cost[y] <span style=color:#f92672>-</span> cost[z]) cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;YES</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;NO</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Code: nhanh hơn</strong></p><ul><li>Độ phức tạp <strong>O(n * logn + m * logn)</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#75715e>#define debug(x) cerr &lt;&lt; #x &lt;&lt; &#34; = &#34; &lt;&lt; x &lt;&lt; endl;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// freopen(&#34;input.txt&#34;, &#34;r&#34;, stdin);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(<span style=color:#ae81ff>0</span>);cin.tie(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin <span style=color:#f92672>&gt;&gt;</span> n <span style=color:#f92672>&gt;&gt;</span> m;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> adj[n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;=</span> n; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, k;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> k;
</span></span><span style=display:flex><span>        adj[x].push_back(make_pair(i, k));
</span></span><span style=display:flex><span>        adj[i].push_back(make_pair(x, k));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> dist(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), cost(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), par(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>void</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> dfs <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> u, <span style=color:#66d9ef>int</span> p){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> val: adj[u]){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> val.first;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> val.second;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(v <span style=color:#f92672>==</span> p) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            par[v] <span style=color:#f92672>=</span> u;
</span></span><span style=display:flex><span>            dist[v] <span style=color:#f92672>=</span> dist[u] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            cost[v] <span style=color:#f92672>=</span> cost[u] <span style=color:#f92672>+</span> x;
</span></span><span style=display:flex><span>            dfs(v, u);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    dfs(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> h <span style=color:#f92672>=</span> ceil(log2(n));
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> sp(h <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; j <span style=color:#f92672>&lt;=</span> n; j<span style=color:#f92672>++</span>) sp[<span style=color:#ae81ff>0</span>][j] <span style=color:#f92672>=</span> par[j];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> h; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; j <span style=color:#f92672>&lt;=</span> n; j<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            sp[i][j] <span style=color:#f92672>=</span> sp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][sp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>][j]];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> find <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> x,<span style=color:#66d9ef>int</span> k){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;=</span> h; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>((k <span style=color:#f92672>&gt;&gt;</span> i)<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span>) x <span style=color:#f92672>=</span> sp[i][x];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>(<span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> lca <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(dist[x] <span style=color:#f92672>&lt;</span> dist[y]) swap(x, y);
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> find(x, dist[x] <span style=color:#f92672>-</span> dist[y]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> h; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>--</span>){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(sp[i][x] <span style=color:#f92672>!=</span> sp[i][y]){
</span></span><span style=display:flex><span>                x <span style=color:#f92672>=</span> sp[i][x];
</span></span><span style=display:flex><span>                y <span style=color:#f92672>=</span> sp[i][y];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(x <span style=color:#f92672>==</span> y) <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> sp[<span style=color:#ae81ff>0</span>][x];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(m<span style=color:#f92672>--</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, y;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> y;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> z <span style=color:#f92672>=</span> lca(x, y);
</span></span><span style=display:flex><span><span style=color:#75715e>//        debug(x)
</span></span></span><span style=display:flex><span><span style=color:#75715e>//        debug(y)
</span></span></span><span style=display:flex><span><span style=color:#75715e>//        debug(z)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span>(dist[x] <span style=color:#f92672>-</span> dist[z] <span style=color:#f92672>&lt;</span> cost[x] <span style=color:#f92672>-</span> cost[z] <span style=color:#f92672>||</span> dist[y] <span style=color:#f92672>-</span> dist[z] <span style=color:#f92672>&lt;</span> cost[y] <span style=color:#f92672>-</span> cost[z]) cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;YES</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;NO</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Hướng dẫn 2: DSU</strong></p><ul><li>Loại bỏ tất cả các cạnh có trọng số là 2.</li></ul><p><strong>Code</strong></p><ul><li>Độ phức tạp <strong>O(nlogn + mlogn)</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#75715e>#define debug(x) cerr &lt;&lt; #x &lt;&lt; &#34; = &#34; &lt;&lt; x &lt;&lt; endl;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>dsu</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> link, sz;
</span></span><span style=display:flex><span>    dsu(<span style=color:#66d9ef>int</span> _n){
</span></span><span style=display:flex><span>        n <span style=color:#f92672>=</span> _n;
</span></span><span style=display:flex><span>        link.assign(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        sz.assign(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> n; i<span style=color:#f92672>++</span>) link[i] <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>find</span>(<span style=color:#66d9ef>int</span> x){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(x <span style=color:#f92672>!=</span> link[x]) <span style=color:#66d9ef>return</span> link[x] <span style=color:#f92672>=</span> find(link[x]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>unite</span>(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b){
</span></span><span style=display:flex><span>        a <span style=color:#f92672>=</span> find(a);
</span></span><span style=display:flex><span>        b <span style=color:#f92672>=</span> find(b);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(a <span style=color:#f92672>==</span> b) <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(sz[a] <span style=color:#f92672>&lt;</span> sz[b]) swap(a, b);
</span></span><span style=display:flex><span>        link[b] <span style=color:#f92672>=</span> a;
</span></span><span style=display:flex><span>        sz[a] <span style=color:#f92672>+=</span> sz[b];
</span></span><span style=display:flex><span>        sz[b] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>same</span>(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> find(a) <span style=color:#f92672>==</span> find(b);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// freopen(&#34;input.txt&#34;, &#34;r&#34;, stdin);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(<span style=color:#ae81ff>0</span>);cin.tie(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin <span style=color:#f92672>&gt;&gt;</span> n <span style=color:#f92672>&gt;&gt;</span> m;
</span></span><span style=display:flex><span>    dsu ds(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;=</span> n; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, k;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> k;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(k <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        ds.unite(i, x);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(m<span style=color:#f92672>--</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x, y;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> x <span style=color:#f92672>&gt;&gt;</span> y;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(ds.same(x, y)) cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;NO</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;YES</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/aohkgnadnart/aohkgnadnart.github.io/commit/a0c8e667603f813f954620fbb5ceb647c3b574bd title='Last modified by aohkgnadnart | April 2, 2025' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt>
<span>April 2, 2025</span></a></div><div><a class="flex align-center" href=#ZgotmplZ target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>